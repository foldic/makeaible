<!DOCTYPE html>
<html lang="cs">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Makeaible - Astravellum project</title>
  <link rel="stylesheet" href="style.css" />
</head>
<body>
  <!-- Stmavení pozadí -->
  <div class="backdrop" id="backdrop" aria-hidden="true"></div>

  <header>
    <h1>Co tě čeká na projektu Astravellum</h1>
    <p>Klikni na obrázek</p>
  </header>

  <!-- Ovál ikon (rx = vodorovný poloměr, ry = svislý, rotate = rotace °, start = startovní úhel °) -->
  <main
    class="circle"
    id="circle"
    aria-label="Ovál ikon projektu"
    data-rx="85%"
    data-ry="45%"
    data-rotate="0"
    data-start="-90"
  >

    <button class="icon" data-label=" ">
      <img src="images/game.png" alt=" " />
      <span class="label">Karetní hra ASTRAVELLUM</span>
      <div class="desc">Popis karetní hry – sem napiš vlastní text.</div>
    </button>

    <button class="icon" data-label=" ">
      <img src="images/book.png" alt=" " />
      <span class="label">Book ASTRAVELLUM</span>
      <div class="desc">A space adventure that goes hand in hand with the game.
It also includes plenty of fascinating information about each of the six alien races, their planetary systems, technologies, and everyday life.</div>
    </button>

    <button class="icon" data-label=" ">
      <img src="images/Figures.png" alt=" " />
      <span class="label">3D figurines of alien</span>
      <div class="desc">10 cm model made from resin</div>
    </button>

    <button class="icon" data-label=" ">
      <img src="images/App.png" alt=" " />
      <span class="label">Mobile app</span>
      <div class="desc">This application will include not only the card game itself, but also the book and many other components of this large-scale project.</div>
    </button>

    <button class="icon" data-label=" ">
      <img src="images/druhá kniha.png" alt=" " />
      <span class="label">Second book</span>
      <div class="desc">This book is an extension of the first one, describing the fate of the Terenai race, which vanished without a trace in the first book.</div>
    </button>

    <button class="icon" data-label=" ">
      <img src="images/Comics.png" alt=" " />
      <span class="label">Comics book</span>
      <div class="desc">Popis rozšíření – sem napiš vlastní text.</div>
    </button>

    <button class="icon" data-label="Sbírka karet">
      <img src="images/cards.png" alt="Sbírka karet" />
      <span class="label">Sbírka karet</span>
      <div class="desc">Popis sbírky karet – sem napiš vlastní text.</div>
    </button>

    <button class="icon" data-label="Komunita">
      <img src="images/community.png" alt="Komunita" />
      <span class="label">Komunita</span>
      <div class="desc">Popis komunity – sem napiš vlastní text.</div>
    </button>

  </main>

  <!-- MODAL -->
  <div class="modal" id="modal" aria-modal="true" role="dialog" hidden>
    <div class="modal-card" id="modalCard">
      <img id="modalImg" alt="">
      <h3 id="modalTitle"></h3>
      <p id="modalDesc"></p>
    </div>
  </div>

  <script>
    // ===== Ovál s plně funkčním rx/ry a živým laděním =====
    const circle = document.getElementById('circle');
    const icons  = Array.from(circle.querySelectorAll('.icon'));

    // Nastavení: když dáš ry v %, vůči čemu se má brát? "width" nebo "height"
    const BASE_FOR_RY_PERCENT = 'width'; // ← změň na "height", pokud chceš

    // převod hodnot "320px" | "40%" | "0.45" | "30vh" | "30vw" (podporuje i 0,45)
    function toPx(val, rect, axis = 'width') {
      if (val == null) return null;
      let s = String(val).trim().replace(',', '.');

      if (s.endsWith('px')) return parseFloat(s);

      if (s.endsWith('%')) {
        const pct = parseFloat(s) / 100;
        const base = axis === 'height' ? rect.height : rect.width;
        return pct * base;
      }

      if (s.endsWith('vh')) return (parseFloat(s) / 100) * window.innerHeight;
      if (s.endsWith('vw')) return (parseFloat(s) / 100) * window.innerWidth;

      const num = parseFloat(s);
      if (Number.isFinite(num)) {
        const base = axis === 'height' ? rect.height : rect.width;
        return num <= 1 ? num * base : num;
      }
      return null;
    }

    function layoutEllipse() {
      if (!icons.length) return;

      const rect = circle.getBoundingClientRect();
      const item = icons[0].getBoundingClientRect().width || 0;
      const pad  = 8;

      const rxAttr = circle.getAttribute('data-rx');
      const ryAttr = circle.getAttribute('data-ry');
      const start  = parseFloat(circle.getAttribute('data-start')  ?? -90);
      const rotate = parseFloat(circle.getAttribute('data-rotate') ?? 0);

      const rxRaw = toPx(rxAttr, rect, 'width')  ?? rect.width  / 2;
      const ryRaw = toPx(ryAttr, rect, BASE_FOR_RY_PERCENT) ?? rect.height / 2;

      const rx = Math.max(0, rxRaw - item / 2 - pad);
      const ry = Math.max(0, ryRaw - item / 2 - pad);

      const n   = icons.length;
      const a0  = (start  * Math.PI) / 180;
      const rot = (rotate * Math.PI) / 180;

      icons.forEach((el, i) => {
        const a  = (2 * Math.PI * i) / n + a0;
        const x0 = Math.cos(a) * rx;
        const y0 = Math.sin(a) * ry;

        const x =  x0 * Math.cos(rot) - y0 * Math.sin(rot);
        const y =  x0 * Math.sin(rot) + y0 * Math.cos(rot);

        el.style.setProperty('--tx', `${x}px`);
        el.style.setProperty('--ty', `${y}px`);
      });
    }

    window.addEventListener('load', layoutEllipse);
    window.addEventListener('resize', () => requestAnimationFrame(layoutEllipse));

    new MutationObserver(layoutEllipse).observe(circle, {
      attributes: true,
      attributeFilter: ['data-rx', 'data-ry', 'data-rotate', 'data-start']
    });

    // ===== Modal logika =====
    const body       = document.body;
    const backdrop   = document.getElementById('backdrop');
    const modal      = document.getElementById('modal');
    const modalCard  = document.getElementById('modalCard');
    const modalImg   = document.getElementById('modalImg');
    const modalTitle = document.getElementById('modalTitle');
    const modalDesc  = document.getElementById('modalDesc');

    function openModal(fromBtn){
      const img   = fromBtn.querySelector('img');
      const title = fromBtn.querySelector('.label')?.textContent || fromBtn.dataset.label || '';
      const desc  = fromBtn.querySelector('.desc')?.textContent || '';

      modalImg.src = img.src;
      modalImg.alt = img.alt || title;
      modalTitle.textContent = title;
      modalDesc.textContent  = desc;

      body.classList.add('modal-open');
      backdrop.classList.add('show'); // viz CSS: reaguje na .modal-open
      modal.hidden = false;
    }
    function closeModal(){
      body.classList.remove('modal-open');
      backdrop.classList.remove('show');
      modal.hidden = true;
      modalImg.removeAttribute('src');
    }

    circle.addEventListener('click', (e)=>{
      const btn = e.target.closest('.icon');
      if (!btn) return;
      openModal(btn);
    });
    backdrop.addEventListener('click', closeModal);
    modalImg.addEventListener('click', closeModal);
    modal.addEventListener('click', (e)=>{
      if (!modalCard.contains(e.target)) closeModal();
    });
    window.addEventListener('keydown', e => { if (e.key === 'Escape') closeModal(); });
  </script>
</body>
</html>

<!--
git add -A
git commit -m "x"
git push
-->
